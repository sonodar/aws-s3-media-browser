# Requirements Document

## Introduction

本ドキュメントは、AWS S3 Photo Browser のジェスチャーナビゲーション機能に関する要件を定義します。モバイルデバイスおよびタッチ対応デバイスでの操作性を向上させるため、スワイプ・長押しなどのジェスチャー操作を導入し、より直感的なユーザー体験を実現します。

現在のアプリケーションではタップ/クリック操作のみが実装されており、プレビュー画面での前後ファイルナビゲーションやジェスチャーによる戻る操作は未実装です。本機能により、モバイルユーザーがネイティブアプリに近い操作感でメディアブラウジングを行えるようになります。

## Non-Goals

本機能のスコープ外とする項目:

- **PC向けキーボードアクセシビリティ**: キーボードナビゲーション（矢印キーでの前後移動等）はモバイルファーストのため対象外
- **モバイルレスポンシブ対応の強化**: 画面サイズに応じたグリッド列数変更などのレイアウト最適化は別機能として扱う
- **スクリーンリーダー対応**: ジェスチャー操作のスクリーンリーダー通知は対象外

## Requirements

### Requirement 1: プレビュー画面での左右スワイプナビゲーション

**Objective:** ユーザーとして、プレビュー画面で左右にスワイプすることで前後のファイルに移動したい。これにより、ボタンをタップせずに連続してメディアを閲覧できる。

#### Acceptance Criteria

1. When ユーザーがプレビュー画面で左方向にスワイプする, the Photo Browser shall 次のファイルのプレビューを表示する
2. When ユーザーがプレビュー画面で右方向にスワイプする, the Photo Browser shall 前のファイルのプレビューを表示する
3. While 最初のファイルを表示中, when ユーザーが右方向にスワイプする, the Photo Browser shall スワイプを無効化するか、端に到達したことを視覚的にフィードバックする
4. While 最後のファイルを表示中, when ユーザーが左方向にスワイプする, the Photo Browser shall スワイプを無効化するか、端に到達したことを視覚的にフィードバックする
5. When スワイプ操作中, the Photo Browser shall スワイプの進行状況を視覚的にフィードバックする（次/前の画像のプレビューが見える等）

### Requirement 2: プレビュー画面での下スワイプによるクローズ

**Objective:** ユーザーとして、プレビュー画面を下にスワイプすることでプレビューを閉じたい。これにより、閉じるボタンを探さずに素早くファイルリストに戻れる。

#### Acceptance Criteria

1. When ユーザーがプレビュー画面で下方向にスワイプする, the Photo Browser shall プレビューモーダルを閉じてファイルリスト画面に戻る
2. When 下スワイプ操作中, the Photo Browser shall プレビュー画像が下方向に移動する視覚的フィードバックを表示する
3. If スワイプ距離が閾値に達しない場合, then the Photo Browser shall プレビュー画像を元の位置に戻し、プレビューを閉じない
4. The Photo Browser shall 下スワイプと左右スワイプを区別し、斜め方向のスワイプは主要な方向（水平または垂直）として解釈する
5. The Photo Browser shall 既存の閉じるボタンによるクローズ機能を維持する

### Requirement 3: ファイルリスト画面での左スワイプによる戻るナビゲーション

**Objective:** ユーザーとして、ファイルリスト画面で左にスワイプすることで1つ上のディレクトリに戻りたい。これにより、戻るボタンをタップせずにフォルダ間を素早く移動できる。

#### Acceptance Criteria

1. When ユーザーがファイルリスト画面で左方向にスワイプする, the Photo Browser shall 1つ上の親ディレクトリに移動する
2. While ルートディレクトリを表示中, when ユーザーが左方向にスワイプする, the Photo Browser shall スワイプを無効化するか、ルートであることを視覚的にフィードバックする
3. When 左スワイプ操作中, the Photo Browser shall 画面遷移の視覚的フィードバックを表示する
4. The Photo Browser shall 縦スクロール中の誤発動を防止するため、水平方向のスワイプのみを検出する
5. The Photo Browser shall 既存の戻るボタンおよびブラウザの戻るボタンによるナビゲーションを維持する

### Requirement 4: ファイルアイテムの長押しによるアクションメニュー表示

**Objective:** ユーザーとして、ファイルリストのアイテムを長押しすることでアクションメニューを表示したい。これにより、直感的な操作でファイル操作にアクセスできる。

#### Acceptance Criteria

1. When ユーザーがファイルリストのアイテムを長押しする（約300-500ミリ秒）, the Photo Browser shall そのアイテムのアクションメニュー（削除、リネーム、移動など）を表示する
2. When 長押しが検出された, the Photo Browser shall 触覚フィードバック（デバイスがサポートしている場合）またはビジュアルフィードバックを提供する
3. If 長押し中にユーザーが指を動かした場合, then the Photo Browser shall 長押しをキャンセルし、通常のスクロールまたはドラッグ操作として処理する
4. When フォルダアイテムを長押しする, the Photo Browser shall フォルダに対して利用可能なアクション（リネーム、削除など）のメニューを表示する
5. The Photo Browser shall 既存のメニューアイコン（⋮）を削除し、長押しをアクションメニューへの唯一のアクセス方法とする

### Requirement 5: ジェスチャー操作の視覚的フィードバック

**Objective:** ユーザーとして、ジェスチャー操作中に視覚的なフィードバックを受け取りたい。これにより、操作が認識されているか確認でき、操作の結果を予測できる。

#### Acceptance Criteria

1. When ジェスチャー操作が完了した, the Photo Browser shall 滑らかなアニメーションで状態遷移を表示する
2. When ジェスチャーがキャンセルまたは閾値未達の場合, the Photo Browser shall 元の状態にアニメーションで戻る

### Requirement 6: ブラウザジェスチャーとの競合回避

**Objective:** ユーザーとして、アプリのジェスチャー操作がブラウザのデフォルト動作と競合せずに動作してほしい。これにより、意図しないブラウザの戻る動作やリフレッシュが発生しない。

#### Acceptance Criteria

1. While ジェスチャー操作中, the Photo Browser shall ブラウザのデフォルトジェスチャー（エッジスワイプによる戻る、プルダウンリフレッシュ等）を適切に抑制する
2. The Photo Browser shall ジェスチャー操作領域とスクロール領域が競合しないよう適切に制御する
3. The Photo Browser shall タッチデバイスおよびポインターデバイスの両方でジェスチャー操作が動作する
